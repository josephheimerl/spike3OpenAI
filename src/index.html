<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>AI Assisted Code Editor</title>
    <link rel="stylesheet" href="styles.css" />
    <link rel="stylesheet" href="loginButton.css" />
    <link rel="stylesheet" href="spikeRepl.css" />
    <script
      defer
      src="./src-min-noconflict/ace.js"
      type="text/javascript"
      charset="utf-8"
    ></script>
    <script defer src="./pyrepl.js"></script>
    <script type="module" defer src="index.js"></script>
  </head>

  <body>
    <div class="head">
      <div id="bar" class="top-bar"></div>
      <div id="title-bar" , class="title-bar">
        <div id="root"></div>
        <h1 id="title" class="center-title">Code SPIKE 3 with AI</h1>
        <div id="sign-in" data-hover="Sign in"></div>
      </div>
    </div>

    <br />
    <div class="two-col-page-body">
      <div class="two-col-page-body-col">
        <div class="toggleable">
          <h4 class="toggleable-head">How To Use <i class="open caret"></i></h4>

          <div class="toggleable-body">
            <p>
              Before doing anything, sign in to Google using the user icon on
              the right side of the head bar, and connect to your SPIKE Prime by
              plugging it in to a serial port and clicking the icon on the left.
            </p>
            <b>
              Make sure any modules your robot may need to import are checked in
              the module dropdown before submiting your prompt.
            </b>
            <p>
              Type what you want your SPIKE robot to do in the text box below,
              and after a few seconds code will be generated and displayed in
              the code editor to the right. If modules are imported which don't
              work for SPIKE 3, ensure the necessary modules are checked in the
              modules dropdown, clear the code, and resubmit your prompt.
            </p>
            <p>
              If there is code in the editor at the time a prompt is submitted,
              the AI will attempt to use work off the existing code in its
              generation. This allows you to give prompts which reference your
              code directly, but means if you want to have a completely fresh
              generation you must clear your code first.
            </p>
            <p>
              Edit the code if you would like, and when you are ready press the
              'Run Code' button to run the code in the editor on the SPIKE.
            </p>
            <p>
              If the AI made any assumptions when writing the code, ie. which
              ports sensors should be plugged in to, it will be displayed in the
              assumptions box.
            </p>
            <p>
              The buttons below the code editor allow you to highlight a portion
              of your existing code and have either an explanation or
              improvement to your selection generate in the response block below
              the coding block.
            </p>
          </div>
        </div>
        <div class="toggle-list" id="moduleDropdownMenu">
          <button class="generic button" id="toggleModules">
            Modules <i class="caret"></i>
          </button>
          <!-- module support dropdown -->
          <div class="dropdown-menu">
            <div class="check-element">
              <input type="checkbox" id="motorCheckbox" checked />
              <label for="motorCheckbox">Motor</label>
            </div>
            <div class="check-element">
              <input type="checkbox" id="distanceSensorCheckbox" />
              <label for="distanceSensorCheckbox">Distance Sensor</label>
            </div>
            <div class="check-element">
              <input type="checkbox" id="hubCheckbox" checked />
              <label for="hubCheckbox">Hub</label>
            </div>
            <div class="check-element">
              <input type="checkbox" id="portCheckbox" checked />
              <label for="portCheckbox">Port</label>
            </div>
            <div class="check-element">
              <input type="checkbox" id="motionSensorCheckbox" />
              <label for="motionSensorCheckbox">Motion Sensor</label>
            </div>
            <div class="check-element">
              <input type="checkbox" id="soundCheckbox" />
              <label for="soundCheckbox">Sound</label>
            </div>
            <div class="check-element">
              <input type="checkbox" id="buttonCheckbox" />
              <label for="buttonCheckbox">Button</label>
            </div>
            <div class="check-element">
              <input type="checkbox" id="forceSensorCheckbox" />
              <label for="forceSensorCheckbox">Force Sensor</label>
            </div>
            <div class="check-element">
              <input type="checkbox" id="colorSensorCheckbox" />
              <label for="colorSensorCheckbox">Color Sensor</label>
            </div>
            <div class="check-element" style="border-bottom: 0">
              <input type="checkbox" id="runloopCheckbox" />
              <label for="runloopCheckbox">Runloop</label>
            </div>
          </div>
        </div>
        <textarea
          id="promptBox"
          name="promptBox"
          class="gpt-prompt-box"
        ></textarea>
        <br />
        <div class="button-panel">
          <button id="submitPrompt" class="button prompt">Submit Prompt</button>

          <button id="runCode" class="button run">Run Code</button>

          <button id="clearCode" class="button clear">Clear Code</button>
        </div>
        <br />
        <br />
        <h4>SPIKE REPL:</h4>
        <div id="repl"></div>
      </div>
      <div class="two-col-page-body-col">
        <div class="toggleable">
          <h4 class="toggleable-head">
            Assumptions <i class="open caret"></i>
          </h4>
          <div class="toggleable-body">
            <div id="assumptionsBox"></div>
          </div>
        </div>
        <div id="code-div">
          <h4>Generated Code:</h4>
          <div id="code-block">
            <pre id="aceEditor"></pre>
          </div>
        </div>
        <button id="explainCode" class="generic button">
          Explain My Selection
        </button>
        <button id="improveCode" class="generic button">
          Suggest Improvement to My Selection
        </button>
        <div class="toggleable">
          <h4 class="toggleable-head">Response <i class="open caret"></i></h4>
          <div class="toggleable-body">
            <div id="responseBox-container" style="position: relative">
              <div id="responseBox"></div>
            </div>
          </div>
        </div>
      </div>
    </div>
    <div class="page-bottom"></div>
  </body>
</html>
